import{c as d,g as Y}from"./_commonjsHelpers-de833af9.js";import{r as w}from"./__federation_shared_react-e93ad879.js";import{j as $}from"./jsx-runtime-5fe4d0a7.js";var D={},N={},b={};Object.defineProperty(b,"__esModule",{value:!0}),b.eventNameFactory=void 0;var ee=function(u,i){return u+":"+i};b.eventNameFactory=ee,Object.defineProperty(N,"__esModule",{value:!0}),N.useNuiEvent=void 0;var M=w,te=b;function ne(u,i,t){u.addEventListener(i,t)}var re=function(u,i,t){var o=M.useRef();M.useEffect(function(){o.current=t},[t]),M.useEffect(function(){var r=te.eventNameFactory(u,i),e=function(a){if(o.current&&o.current.call){var s=a.data,l=s;o.current(l)}};return ne(window,r,e),function(){return window.removeEventListener(r,e)}},[u,i])};N.useNuiEvent=re;var C={},m={};Object.defineProperty(m,"__esModule",{value:!0}),m.NuiContext=void 0;var ue=w;m.NuiContext=ue.createContext(null),Object.defineProperty(C,"__esModule",{value:!0}),C.useNuiCallback=void 0;var f=w,oe=m,ie=b,H=N,ae=function(u,i,t,o){var r=f.useContext(oe.NuiContext),e=r.sendAbortable,a=r.callbackTimeout,s=f.useRef(),l=f.useRef(),n=f.useRef(ie.eventNameFactory(u,i)),c=f.useRef(i),v=f.useRef(u),y=f.useState(!1),h=y[0],T=y[1],F=f.useState(!1),Q=F[0],A=F[1],L=f.useState(!1),j=L[0],O=L[1],q=f.useState(null),V=q[0],P=q[1],G=f.useState(null),W=G[0],k=G[1],Z=f.useCallback(function(p){j&&(l.current&&clearTimeout(l.current),!h&&(k(p),P(null),O(!1),t==null||t(p)))},[t,h,j]),R=f.useCallback(function(p){l.current&&clearTimeout(l.current),P(p),k(null),O(!1),o==null||o(p)},[o]);H.useNuiEvent(v.current,c.current+"Success",Z),H.useNuiEvent(v.current,c.current+"Error",R);var B=f.useCallback(function(p,U){O(function(J){if(!J){T(!1),A(!1),P(null),k(null),s.current=e(c.current,p),s.current.promise.catch(function(X){h||(R(X),A(!0),l.current=void 0,s.current=void 0)});var z=U||{timeout:a},S=z.timeout===!1?!1:z.timeout||a;return S&&!Q&&(clearTimeout(l.current),l.current=setTimeout(function(){T(!0),R(new Error('fivem-nui-react-lib: "'+n.current+'" event callback timed out after '+S+" milliseconds")),s.current&&s.current.abort(),l.current=void 0,s.current=void 0},S)),!0}return J})},[]);return[B,{loading:j,response:W,error:V}]};C.useNuiCallback=ae;var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.useNuiRequest=void 0;var I=w,ce=m,se=function(u){var i=u===void 0?{}:u,t=i.resource,o=I.useContext(ce.NuiContext);if(!o)throw new Error("fivem-nui-react-lib: useNuiRequest must be used inside NuiProvider passing the `resource` prop");var r=o.send,e=o.sendAbortable;return I.useMemo(function(){return{send:function(a,s){return s===void 0&&(s={}),r(a,s,t)},sendAbortable:function(a,s){return s===void 0&&(s={}),e(a,s,t)}}},[r,e,t])};E.useNuiRequest=se;var x={},_=d&&d.__assign||function(){return _=Object.assign||function(u){for(var i,t=1,o=arguments.length;t<o;t++){i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(u[r]=i[r])}return u},_.apply(this,arguments)},le=d&&d.__awaiter||function(u,i,t,o){function r(e){return e instanceof t?e:new t(function(a){a(e)})}return new(t||(t=Promise))(function(e,a){function s(c){try{n(o.next(c))}catch(v){a(v)}}function l(c){try{n(o.throw(c))}catch(v){a(v)}}function n(c){c.done?e(c.value):r(c.value).then(s,l)}n((o=o.apply(u,i||[])).next())})},fe=d&&d.__generator||function(u,i){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},o,r,e,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(n){return function(c){return l([n,c])}}function l(n){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,r&&(e=n[0]&2?r.return:n[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,n[1])).done)return e;switch(r=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return t.label++,{value:n[1],done:!1};case 5:t.label++,r=n[1],n=[0];continue;case 7:n=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){t=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){t.label=n[1];break}if(n[0]===6&&t.label<e[1]){t.label=e[1],e=n;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(n);break}e[2]&&t.ops.pop(),t.trys.pop();continue}n=i.call(u,t)}catch(c){n=[6,c],r=0}finally{o=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(x,"__esModule",{value:!0}),x.NuiProvider=void 0;var ve=$,g=w,de=m,pe=b;function be(u,i){var t=new AbortController,o=t.signal;return{abort:function(){return t.abort()},promise:fetch(u,_(_({},i),{signal:o}))}}function K(u,i,t){return["https://"+u+"/"+i,{method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(t)}]}var me=1e4,ye=function(u){var i=u.resource,t=u.children,o=u.timeout,r=g.useRef(i||""),e=g.useRef(o||me),a=function(n){var c=n.data,v=c.app,y=c.method,h=c.data;v&&y&&window.dispatchEvent(new MessageEvent(pe.eventNameFactory(v,y),{data:h}))};g.useEffect(function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}},[]);var s=g.useCallback(function(n,c,v){return c===void 0&&(c={}),le(void 0,void 0,void 0,function(){return fe(this,function(y){return[2,fetch.apply(void 0,K(v||r.current,n,c))]})})},[]),l=g.useCallback(function(n,c,v){return c===void 0&&(c={}),be.apply(void 0,K(v||r.current,n,c))},[]);return ve.jsx(de.NuiContext.Provider,_({value:{send:s,sendAbortable:l,resource:r.current,callbackTimeout:e.current}},{children:t}),void 0)};x.NuiProvider=ye,function(u){var i=d&&d.__createBinding||(Object.create?function(o,r,e,a){a===void 0&&(a=e),Object.defineProperty(o,a,{enumerable:!0,get:function(){return r[e]}})}:function(o,r,e,a){a===void 0&&(a=e),o[a]=r[e]}),t=d&&d.__exportStar||function(o,r){for(var e in o)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&i(r,o,e)};Object.defineProperty(u,"__esModule",{value:!0}),t(N,u),t(C,u),t(E,u),t(m,u),t(x,u),t(b,u)}(D);const he=Y(D);export{he as default};
